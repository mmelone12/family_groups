<%= render :partial => 'js/compose.js.erb' %>
<div class='b-compose', style='color:white; text-align:center'>
  Compose
</div>
<h3 class="inbox">YOUR <%=h @folder.name %></h3>

<table border="1">
  <tr>
    <th><strong>From</strong></th>
    <th><strong>Subject</strong></th>
    <th><strong>Received</strong></th>
    <th><strong>Body</strong></th>
  </tr>
  <% @messages.each do |message| %>
    <tr>
      <td><%=h message.author.name %></td>
      <td><%= message.subject.truncate(60) %></td>
      <td><%= distance_of_time_in_words(message.created_at, Time.now) %> ago</td>
      <td><%= message.body.truncate(100) %></td> 
      </div>
    </tr>
    <%= render :partial => 'js/message.js.erb', :locals => { :message => message } %>
  <% end %>
  </table>
  
<%= will_paginate @messages %>
    <h3 class="inbox">SENT MESSAGES</h3>

    <table border="1">
      <tr>
        <th><strong>To</strong></th>
        <th><strong>Subject</strong></th>
        <th><strong>Sent</strong></th>
        <th><strong>Body</strong></th>
      </tr>

      <% for message in @messages %>
        <tr>
          <td><%=h message.recipients.map(&:name).to_sentence %></td>
          <td><%= link_to h(message.subject.truncate(60)), sent_path(message) %></td>
          <td><%= distance_of_time_in_words(message.created_at, Time.now) %> ago</td>
          <td><%= link_to h(message.body.truncate(100)), sent_path(message) %></td> 
        </tr>
      <% end %>
    </table>

    <%= will_paginate @messages %>
  </div>
</div>